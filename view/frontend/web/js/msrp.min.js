define(["jquery","Magento_Customer/js/customer-data"],function(b,g){return function(c){b.widget("mage.addToCart",c,{_addToCartSubmit:function(f){var a=this;if("undefined"===typeof cbrequire){a.element.trigger("addToCart",a.element);if(a.element.data("stop-processing"))return!1;if(a.options.addToCartButton)return b(a.options.addToCartButton).click(),!1;a.options.addToCartUrl&&b(".mage-dropdown-dialog > .ui-dialog-content").dropdownDialog("close");f.preventDefault();b(a.options.cartForm).submit()}else cbrequire(["configbox/server",
"configbox/configurator"],function(c,e){e={cartPositionId:e.getCartPositionId()};c.makeRequest("configuratorpage","getMissingSelections",e).done(function(d){if(0===d.length){a.element.trigger("addToCart",a.element);if(a.element.data("stop-processing"))return!1;if(a.options.addToCartButton)return b(a.options.addToCartButton).click(),!1;a.options.addToCartUrl&&b(".mage-dropdown-dialog > .ui-dialog-content").dropdownDialog("close");f.preventDefault();b(a.options.cartForm).submit()}else{var c=[];d.forEach(function(a){c.push(a.title)});
d="Before finishing the configuration you have to make a choice for these required elements: "+c.join(", ");g.set("messages",{messages:[{type:"error",text:b.mage.__(d)}]})}})});return!1}})}});
